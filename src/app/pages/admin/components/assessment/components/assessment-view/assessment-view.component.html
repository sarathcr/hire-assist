<div class="assessment-schedule">
  <!-- Hero Header Section -->
  <div class="assessment-schedule__hero">
    <div class="assessment-schedule__hero-content">
      <div class="assessment-schedule__hero-title-section">
        <h1 class="assessment-schedule__hero-title">
          <i class="pi pi-calendar-plus"></i>
          Schedule Recruitment
        </h1>
        @if (assessment) {
          <p class="assessment-schedule__hero-subtitle">
            {{ assessment.name }}
          </p>
        }
      </div>
      @if (assessment) {
        <div class="assessment-schedule__hero-badge">
          <i class="pi pi-info-circle"></i>
          <span>Assessment Details</span>
        </div>
      }
    </div>
  </div>

  <!-- Assessment Info Cards -->
  @if (assessment) {
    <div class="assessment-schedule__info-grid">
      <div class="assessment-schedule__info-card">
        <div class="assessment-schedule__info-icon">
          <i class="pi pi-calendar"></i>
        </div>
        <div class="assessment-schedule__info-content">
          <span class="assessment-schedule__info-label">Start Date</span>
          <span class="assessment-schedule__info-value">
            {{ assessment.startDateTime | date: "dd MMM yyyy" }}
          </span>
        </div>
      </div>
      <div class="assessment-schedule__info-card">
        <div class="assessment-schedule__info-icon">
          <i class="pi pi-calendar-times"></i>
        </div>
        <div class="assessment-schedule__info-content">
          <span class="assessment-schedule__info-label">End Date</span>
          <span class="assessment-schedule__info-value">
            {{ assessment.endDateTime | date: "dd MMM yyyy" }}
          </span>
        </div>
      </div>
      <div class="assessment-schedule__info-card assessment-schedule__info-card--full">
        <div class="assessment-schedule__info-icon">
          <i class="pi pi-file-edit"></i>
        </div>
        <div class="assessment-schedule__info-content">
          <span class="assessment-schedule__info-label">Description</span>
          <span class="assessment-schedule__info-value">
            {{ assessment.description || 'No description provided' }}
          </span>
        </div>
      </div>
    </div>
  }

  <!-- Modern Step Navigation -->
  <div class="assessment-schedule__stepper-wrapper">
    <div class="assessment-schedule__stepper">
      @for (step of stepConfig; track step.index; let i = $index) {
        <div
          class="assessment-schedule__stepper-item"
          [ngClass]="{
            'active': activeStep === step.index,
            'completed': stepsLoaded && stepsStatus[stepKeys[step.index]] === 'Completed',
            'disabled': !stepsLoaded || !isStepEnabled(step.index),
            'pending': stepsLoaded && stepsStatus[stepKeys[step.index]] === 'Pending'
          }"
        >
          <button
            type="button"
            class="assessment-schedule__stepper-button"
            [disabled]="!stepsLoaded || !isStepEnabled(step.index)"
            (click)="setActiveStep(step.index)"
            [attr.aria-label]="step.label"
          >
            <div class="assessment-schedule__stepper-indicator">
              @if (stepsLoaded && stepsStatus[stepKeys[step.index]] === 'Completed') {
                <i class="pi pi-check"></i>
              } @else {
                <i [class]="step.icon"></i>
              }
            </div>
            <div class="assessment-schedule__stepper-content">
              <span class="assessment-schedule__stepper-label">{{ step.label }}</span>
            </div>
            @if (activeStep === step.index) {
              <div class="assessment-schedule__stepper-arrow">
                <i class="pi pi-chevron-down"></i>
              </div>
            }
          </button>
          @if (i < stepConfig.length - 1) {
            <div class="assessment-schedule__stepper-connector"
                 [ngClass]="{'completed': stepsLoaded && stepsStatus[stepKeys[step.index]] === 'Completed'}">
            </div>
          }
        </div>
      }
    </div>
  </div>

  <!-- Progress Bar -->
  <div class="assessment-schedule__progress">
    <div class="assessment-schedule__progress-bar">
      <div
        class="assessment-schedule__progress-fill"
        [style.width.%]="getProgressPercentage()">
      </div>
    </div>
    <span class="assessment-schedule__progress-text">
      {{ getProgressPercentage() }}% Complete
    </span>
  </div>

  <!-- Content Area -->
  <div class="assessment-schedule__content-wrapper">
    <div class="assessment-schedule__content-header">
      <h2 class="assessment-schedule__content-title">
        @if (stepConfig[activeStep]) {
          <i [class]="stepConfig[activeStep].icon"></i>
          {{ stepConfig[activeStep].label }}
        }
      </h2>
      <p class="assessment-schedule__content-description">
        @if (stepConfig[activeStep]) {
          {{ stepConfig[activeStep].description }}
        }
      </p>
    </div>
    <div class="assessment-schedule__content">
      @if (this.activeStep === 0) {
        <app-assessment-round
          [assessmentId]="assessmentId"
        ></app-assessment-round>
      } @else if (this.activeStep === 1) {
        <app-select-quesionset-step
          [assessmentId]="assessmentId"
        ></app-select-quesionset-step>
      } @else if (this.activeStep === 2) {
        <app-coordinator-step
          [assessmentId]="assessmentId"
        ></app-coordinator-step>
      } @else if (this.activeStep === 3) {
        <app-front-desk [assessmentId]="assessmentId"></app-front-desk>
      } @else if (this.activeStep === 4) {
        <app-import-candidate-list-step
          [assessmentId]="assessmentId"
        ></app-import-candidate-list-step>
      }
    </div>
  </div>

  <!-- <p-stepper [value]="1">
    <p-step-item [value]="1">
      <p-step
        ><div class="assessment-schedule__step-content">
          ASSESSMENT ROUNDS
        </div></p-step
      >
      <p-step-panel>
        <ng-template #content let-activateCallback="activateCallback">
          <div class="assessment-schedule__box">
            <app-assessment-round
              [assessmentId]="assessmentId"
            ></app-assessment-round>
          </div>

          <div class="assessment-schedule__footer">
            <p-button
              label="Complete"
              (onClick)="onCompleteStep(1)"
              [disabled]="isdisableCompleted"
            />
            <p-button
              label="Next"
              *ngIf="completedSteps.includes(1) || isdisableCompleted"
              (onClick)="activateCallback(2)"
            />
          </div>
        </ng-template>
      </p-step-panel>
    </p-step-item>

    <p-step-item [value]="2">
      <p-step
        ><div class="assessment-schedule__step-content">
          SELECT ASSESSMENT QUESTIONS AND SET QUESTION SET
        </div></p-step
      >
      <p-step-panel>
        <ng-template #content let-activateCallback="activateCallback">
          <div class="assessment-schedule__box">
            <app-select-quesionset-step
              [assessmentId]="assessmentId"
            ></app-select-quesionset-step>
          </div>
          <div class="assessment-schedule__footer">
            <app-button
              [buttonLabel]="'Back'"
              [buttonVariant]="'outlined'"
              (btnClick)="activateCallback(1)"
            ></app-button>
            <p-button
              label="Complete"
              (onClick)="onCompleteStep(2)"
              [disabled]="completedSteps.includes(2)"
            />
            <p-button
              label="Next"
              *ngIf="completedSteps.includes(2)"
              (onClick)="activateCallback(3)"
            />
          </div>
        </ng-template>
      </p-step-panel>
    </p-step-item> -->

  <!--FrontDesk-->

  <!-- <p-step-item [value]="3">
      <p-step
        ><div class="assessment-schedule__step-content">
          CHOOSE COORDINATORS
        </div></p-step
      >
      <p-step-panel>
        <ng-template #content let-activateCallback="activateCallback">
          <div class="assessment-schedule__box">
            <app-coordinator-step
              [assessmentId]="assessmentId"
            ></app-coordinator-step>
          </div>
          <div class="assessment-schedule__footer">
            <app-button
              [buttonLabel]="'Back'"
              [buttonVariant]="'outlined'"
              (btnClick)="activateCallback(2)"
            ></app-button>
            <p-button
              label="Complete"
              (onClick)="onCompleteStep(3)"
              [disabled]="completedSteps.includes(3)"
            />
            <p-button
              label="Next"
              *ngIf="completedSteps.includes(3)"
              (onClick)="activateCallback(4)"
            />
          </div>
        </ng-template>
      </p-step-panel>
    </p-step-item>
    <p-step-item [value]="4">
      <p-step
        ><div class="assessment-schedule__step-content">
          CHOOSE FRONTDESK COORDINATORS
        </div></p-step
      >
      <p-step-panel>
        <ng-template #content let-activateCallback="activateCallback">
          <div class="assessment-schedule__box">
            <app-front-desk [assessmentId]="assessmentId"></app-front-desk>
          </div>

          <div class="assessment-schedule__footer">
            <app-button
              [buttonLabel]="'Back'"
              [buttonVariant]="'outlined'"
              (btnClick)="activateCallback(3)"
            ></app-button>
            <p-button
              label="Complete"
              (onClick)="onCompleteStep(4)"
              [disabled]="completedSteps.includes(4)"
            />
            <p-button
              label="Next"
              *ngIf="completedSteps.includes(4)"
              (onClick)="activateCallback(5)"
            />
          </div>
        </ng-template>
      </p-step-panel>
    </p-step-item>

    <p-step-item [value]="5">
      <p-step
        ><div class="assessment-schedule__step-content">
          ASSIGN INTERVIEWERS
        </div></p-step
      >
      <p-step-panel>
        <ng-template #content let-activateCallback="activateCallback">
          <div class="assessment-schedule__box">
            <app-assign-panel-interviewer [assessmentId]="assessmentId"></app-assign-panel-interviewer>
          </div>
          <div class="assessment-schedule__footer">
            <app-button
              [buttonLabel]="'Back'"
              [buttonVariant]="'outlined'"
              (btnClick)="activateCallback(4)"
            ></app-button>
            <p-button
              label="Complete"
              (onClick)="onCompleteStep(5)"
              [disabled]="completedSteps.includes(5)"
            />
            <p-button
              label="Next"
              *ngIf="completedSteps.includes(5)"
              (onClick)="activateCallback(6)"
            />
          </div>
        </ng-template>
      </p-step-panel>
    </p-step-item>

    <p-step-item [value]="6">
      <p-step
        ><div class="assessment-schedule__step-content">
          IMPORT CANDIDATE LIST AND SCHEDULE ASSESSMENT
        </div></p-step
      >
      <p-step-panel>
        <ng-template #content let-activateCallback="activateCallback">
          <div class="assessment-schedule__box">
            <app-import-candidate-list-step
              [assessmentId]="assessmentId"
            ></app-import-candidate-list-step>
          </div>
          <div class="assessment-schedule__footer">
            <app-button
              [buttonLabel]="'Back'"
              [buttonVariant]="'outlined'"
              (btnClick)="activateCallback(5)"
            ></app-button>
            <p-button
              label="Complete"
              (onClick)="onCompleteStep(6)"
              [disabled]="isdisableCompleted"
            />
          </div>
        </ng-template>
      </p-step-panel>
    </p-step-item>
  </p-stepper> -->
</div>
